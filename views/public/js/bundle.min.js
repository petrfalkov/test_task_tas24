function buildCharts(t,s,a){Highcharts.ajax({url:t,dataType:"text",success:function(t){var e=t.split("\n"),r={chart:{type:"column"},title:{text:s},xAxis:{categories:[],labels:{rotation:-90}},yAxis:{title:{text:"Кол-во клиентов"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"gray"}}},legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0,align:"left",color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white"}}},credits:{enabled:!1},series:[]},i=[];i=e[0].substring(1,e[0].length-1).split(","),i=i.concat(e[2].substring(1,e[2].length-1).split(",")),i=i.concat(e[4].substring(1,e[4].length-1).split(",")),i.forEach(function(t){t=t.trim(),-1===$.inArray(t,r.xAxis.categories)&&r.xAxis.categories.push(t)}),r.xAxis.categories.sort(),e.forEach(function(t,s){var a,n;switch(s){case 0:n={name:"Открыли (сайт)",data:[]},i=e[0].substring(1,e[0].length-1).split(","),a=e[1].substring(1,e[1].length-1).split(","),i.forEach(function(t,s){t=t.trim(),n.data.push([$.inArray(t,r.xAxis.categories),parseInt(a[s],10)])}),r.series.push(n);break;case 2:n={name:"Открыли (бранч)",data:[]},i=e[2].substring(1,e[2].length-1).split(","),a=e[3].substring(1,e[3].length-1).split(","),i.forEach(function(t,s){t=t.trim(),n.data.push([$.inArray(t,r.xAxis.categories),parseInt(a[s],10)])}),r.series.push(n);break;case 4:n={name:"Закрыли счёт",data:[]},i=e[4].substring(1,e[4].length-1).split(","),a=e[5].substring(1,e[5].length-1).split(","),i.forEach(function(t,s){t=t.trim(),n.data.push([$.inArray(t,r.xAxis.categories),-parseInt(a[s],10)])}),r.series.push(n)}}),Highcharts.chart(a,r)},error:function(t,s){console.error(t,s)}})}$(document).ready(function(){buildCharts("/charts/phis_osoba.csv","Открытие/закрытие клиентов Предпринимателей по дням","container1"),buildCharts("/charts/ur_osoba.csv","Открытие/закрытие клиентов UR по дням","container2")});