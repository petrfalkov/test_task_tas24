function buildCharts(t,s,a){Highcharts.ajax({url:t,dataType:"text",success:function(t){var i=t.split("\n");options={chart:{type:"column"},title:{text:s},xAxis:{categories:[]},yAxis:{title:{text:"Кол-во клиентов"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"gray"}}},legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white"}}},credits:{enabled:!1},series:[]};var e=0;i.forEach(function(t,s){var a,r,o;switch(s){case 0:o={name:"Открыли (сайт)",data:[]},a=i[0].substring(1,i[0].length-1).split(","),r=i[1].substring(1,i[1].length-1).split(","),a.forEach(function(t,s){t=t.trim(),options.xAxis.categories.push(t),o.data.push([e,parseInt(r[s],10)]),e++}),options.series.push(o);break;case 2:o={name:"Открыли (бранч)",data:[]},a=i[2].substring(1,i[2].length-1).split(","),r=i[3].substring(1,i[3].length-1).split(","),a.forEach(function(t,s){t=t.trim(),-1===$.inArray(t,options.xAxis.categories)?(options.xAxis.categories.push(t),o.data.push([e,parseInt(r[s],10)]),e++):o.data.push([$.inArray(t,options.xAxis.categories),parseInt(r[s],10)])}),options.series.push(o);break;case 4:o={name:"Закрыли счёт",data:[]},a=i[4].substring(1,i[4].length-1).split(","),r=i[5].substring(1,i[5].length-1).split(","),a.forEach(function(t,s){t=t.trim(),-1===$.inArray(t,options.xAxis.categories)?(options.xAxis.categories.push(t),o.data.push([e,-parseInt(r[s],10)]),e++):o.data.push([$.inArray(t,options.xAxis.categories),-parseInt(r[s],10)])}),options.series.push(o)}}),Highcharts.chart(a,options)},error:function(t,s){console.error(t,s)}})}$(document).ready(function(){buildCharts("/charts/phis_osoba.csv","Открытие/закрытие клиентов Предпринимателей по дням","container1"),buildCharts("/charts/ur_osoba.csv","Открытие/закрытие клиентов UR по дням","container2")});